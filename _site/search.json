[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "class02",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.0      ✔ purrr   0.3.5 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n\nlibrary(lubridate)\n\nLoading required package: timechange\n\nAttaching package: 'lubridate'\n\nThe following objects are masked from 'package:base':\n\n    date, intersect, setdiff, union\n\nggthemr::ggthemr(\"fresh\")\n\nbikes <- ISLR2::Bikeshare |> tibble()\n\nbikes <- bikes |> \n  mutate(\n    season = factor(season, labels = c(\"winter\", \"spring\", \"summer\", \"fall\"))\n  ) |> \n  mutate(\n    date = as.Date(day, origin = \"2010-12-31\"),\n    datetime = make_datetime(year(date), month(date), mday(date), hr)\n  )\n\nglimpse(bikes)\n\nRows: 8,645\nColumns: 17\n$ season     <fct> winter, winter, winter, winter, winter, winter, winter, win…\n$ mnth       <fct> Jan, Jan, Jan, Jan, Jan, Jan, Jan, Jan, Jan, Jan, Jan, Jan,…\n$ day        <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ hr         <fct> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1…\n$ holiday    <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ weekday    <dbl> 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,…\n$ workingday <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ weathersit <fct> clear, clear, clear, clear, clear, cloudy/misty, clear, cle…\n$ temp       <dbl> 0.24, 0.22, 0.22, 0.24, 0.24, 0.24, 0.22, 0.20, 0.24, 0.32,…\n$ atemp      <dbl> 0.2879, 0.2727, 0.2727, 0.2879, 0.2879, 0.2576, 0.2727, 0.2…\n$ hum        <dbl> 0.81, 0.80, 0.80, 0.75, 0.75, 0.75, 0.80, 0.86, 0.75, 0.76,…\n$ windspeed  <dbl> 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0896, 0.0000, 0.0…\n$ casual     <dbl> 3, 8, 5, 3, 0, 0, 2, 1, 1, 8, 12, 26, 29, 47, 35, 40, 41, 1…\n$ registered <dbl> 13, 32, 27, 10, 1, 1, 0, 2, 7, 6, 24, 30, 55, 47, 71, 70, 5…\n$ bikers     <dbl> 16, 40, 32, 13, 1, 1, 2, 3, 8, 14, 36, 56, 84, 94, 106, 110…\n$ date       <date> 2011-01-01, 2011-01-01, 2011-01-01, 2011-01-01, 2011-01-01…\n$ datetime   <dttm> 2011-01-01 01:00:00, 2011-01-01 02:00:00, 2011-01-01 03:00…\n\n# 날에 따른 변화\nbikes_daily <- \n  bikes |> \n  group_by(date) |> \n  summarise(n = sum(bikers),\n            temp_h = max(temp),\n            temp_l = min(temp),\n            temp_m = mean(temp))\nbikes_daily\n\n# A tibble: 365 × 5\n   date           n temp_h temp_l temp_m\n   <date>     <dbl>  <dbl>  <dbl>  <dbl>\n 1 2011-01-01   985   0.46   0.2   0.344\n 2 2011-01-02   801   0.46   0.22  0.363\n 3 2011-01-03  1349   0.26   0.14  0.196\n 4 2011-01-04  1562   0.3    0.12  0.2  \n 5 2011-01-05  1600   0.3    0.16  0.227\n 6 2011-01-06  1606   0.28   0.14  0.204\n 7 2011-01-07  1510   0.22   0.16  0.197\n 8 2011-01-08   959   0.2    0.1   0.165\n 9 2011-01-09   822   0.22   0.08  0.138\n10 2011-01-10  1321   0.2    0.1   0.151\n# … with 355 more rows\n\nbikes_daily <-\n  bikes_daily |> \n  mutate(wday = wday(date, label = TRUE),\n         month = month(date, label = TRUE))\nbikes_daily\n\n# A tibble: 365 × 7\n   date           n temp_h temp_l temp_m wday  month\n   <date>     <dbl>  <dbl>  <dbl>  <dbl> <ord> <ord>\n 1 2011-01-01   985   0.46   0.2   0.344 Sat   Jan  \n 2 2011-01-02   801   0.46   0.22  0.363 Sun   Jan  \n 3 2011-01-03  1349   0.26   0.14  0.196 Mon   Jan  \n 4 2011-01-04  1562   0.3    0.12  0.2   Tue   Jan  \n 5 2011-01-05  1600   0.3    0.16  0.227 Wed   Jan  \n 6 2011-01-06  1606   0.28   0.14  0.204 Thu   Jan  \n 7 2011-01-07  1510   0.22   0.16  0.197 Fri   Jan  \n 8 2011-01-08   959   0.2    0.1   0.165 Sat   Jan  \n 9 2011-01-09   822   0.22   0.08  0.138 Sun   Jan  \n10 2011-01-10  1321   0.2    0.1   0.151 Mon   Jan  \n# … with 355 more rows\n\nbikes_daily |> \n  ggplot(aes(x = date, y = n)) +\n  geom_line()\n\n\n\n# 요일에 따라 차이가 있는가?\nbikes_daily |> \n  ggplot(aes(x = wday, y = n)) +\n  geom_boxplot()\n\n\n\n# 달(기온)에 따라 차이가 있는가?\nbikes_daily |> \n  ggplot(aes(x = month, y = n)) +\n  geom_boxplot()\n\n\n\nbikes_daily |> \n  ggplot(aes(x = temp_h, y = n)) +\n  geom_point(alpha = .6) +\n  geom_smooth()\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\n\n\nbikes_daily |> \n  ggplot(aes(x = temp_l, y = n)) +\n  geom_point(alpha = .6) +\n  geom_smooth()\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\n\n\nbikes_daily |> \n  ggplot(aes(x = temp_m, y = n)) +\n  geom_point(alpha = .6) +\n  geom_smooth()\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\n\n\nlibrary(splines)\nbikes_daily |> \n  ggplot(aes(x = temp_m, y = n)) +\n  geom_point(alpha = .6) +\n  geom_smooth(method = \"lm\", formula = y ~ ns(x, 3))\n\n\n\nlibrary(psych)\n\n\nAttaching package: 'psych'\n\nThe following objects are masked from 'package:ggplot2':\n\n    %+%, alpha\n\ncorr.test(bikes_daily |> select(starts_with(\"temp\")))  \n\nCall:corr.test(x = select(bikes_daily, starts_with(\"temp\")))\nCorrelation matrix \n       temp_h temp_l temp_m\ntemp_h   1.00   0.95   0.98\ntemp_l   0.95   1.00   0.98\ntemp_m   0.98   0.98   1.00\nSample Size \n[1] 365\nProbability values (Entries above the diagonal are adjusted for multiple tests.) \n       temp_h temp_l temp_m\ntemp_h      0      0      0\ntemp_l      0      0      0\ntemp_m      0      0      0\n\n To see confidence intervals of the correlations, print with the short=FALSE option\n\nmod <- lm(n ~ ns(temp_m, 3), data = bikes_daily)\nsummary(mod)\n\n\nCall:\nlm(formula = n ~ ns(temp_m, 3), data = bikes_daily)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3482.2  -443.1    32.2   518.5  1702.5 \n\nCoefficients:\n               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)       842.3      261.4   3.222  0.00139 ** \nns(temp_m, 3)1   3861.1      194.9  19.809  < 2e-16 ***\nns(temp_m, 3)2   4811.7      622.1   7.735 1.04e-13 ***\nns(temp_m, 3)3   2383.7      210.7  11.314  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 817.8 on 361 degrees of freedom\nMultiple R-squared:  0.6511,    Adjusted R-squared:  0.6482 \nF-statistic: 224.5 on 3 and 361 DF,  p-value: < 2.2e-16\n\nlibrary(modelr)\nbikes_daily <- \n  bikes_daily |> \n  add_residuals(mod)\n\nbikes_daily |> \n  ggplot(aes(x = date, y = resid)) +\n  geom_line()\n\n\n\nbikes_daily |> \n  ggplot(aes(x = month, y = resid)) +\n  geom_boxplot()\n\n\n\n# seasons\nbikes |> \n  group_by(season) |> \n  summarise(start = min(date),\n            end = max(date))\n\n# A tibble: 4 × 3\n  season start      end       \n  <fct>  <date>     <date>    \n1 winter 2011-01-01 2011-12-31\n2 spring 2011-03-21 2011-06-20\n3 summer 2011-06-21 2011-09-22\n4 fall   2011-09-23 2011-12-20\n\nseason <- function(date) {\n  cut(date, \n      breaks = ymd(20110101, 20110321, 20110620, 20110922, 20111220, 20111231),\n      labels = c(\"winter\", \"spring\", \"summer\", \"fall\", \"winter\") \n  )\n} \n\nbikes_daily <- \n  bikes_daily |> \n  mutate(season = season(date))\n\nbikes_daily |> \n  ggplot(aes(x = date, y = resid, color = season)) +\n  geom_point()\n\nWarning: Removed 1 rows containing missing values (`geom_point()`).\n\n\n\n\nbikes_daily |> \n  ggplot(aes(x = temp_m, y = n, color = season)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE, formula = y ~ ns(x, 3))\n\nWarning: Removed 1 rows containing missing values (`geom_point()`).\n\n\n\n\n(p <- bikes_daily |> \n  ggplot(aes(x = date, y = resid)) +\n  geom_point() +\n  geom_hline(yintercept = 0))\n\n\n\n# install.packages(\"plotly\")\nlibrary(plotly)\n\n\nAttaching package: 'plotly'\n\nThe following object is masked from 'package:ggplot2':\n\n    last_plot\n\nThe following object is masked from 'package:stats':\n\n    filter\n\nThe following object is masked from 'package:graphics':\n\n    layout\n\nggplotly(p)\n\n\n\n\nseason2 <- function(date) {\n  cut(date, \n      breaks = ymd(20110101, 20110417, 20111001, 20111231),\n      labels = c(\"winter(1.1~4.16)\", \"spring/summer(~9.30)\", \"fall(~12.31)\") \n  )\n} \n\nbikes_daily <- \n  bikes_daily |> \n  mutate(season2 = season2(date))\n\nbikes_daily |> \n  ggplot(aes(x = temp_m, y = n, color = season2)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE, formula = y ~ ns(x, 3))\n\nWarning: Removed 1 rows containing missing values (`geom_point()`).\n\n\n\n\n# model\nmod2 <- lm(n ~ ns(temp_m, 3) + season2, data = bikes_daily)\nsummary(mod2)\n\n\nCall:\nlm(formula = n ~ ns(temp_m, 3) + season2, data = bikes_daily)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3477.1  -324.1   135.4   463.8  1528.0 \n\nCoefficients:\n                            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                   1138.3      238.8   4.767 2.73e-06 ***\nns(temp_m, 3)1                2539.8      253.1  10.036  < 2e-16 ***\nns(temp_m, 3)2                2494.6      600.1   4.157 4.04e-05 ***\nns(temp_m, 3)3                1443.8      260.8   5.536 5.99e-08 ***\nseason2spring/summer(~9.30)   1213.0      178.7   6.789 4.70e-11 ***\nseason2fall(~12.31)           1145.5      117.7   9.736  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 725.4 on 358 degrees of freedom\n  (1 observation deleted due to missingness)\nMultiple R-squared:  0.7274,    Adjusted R-squared:  0.7236 \nF-statistic: 191.1 on 5 and 358 DF,  p-value: < 2.2e-16\n\nbikes_daily <- \n  bikes_daily |> \n  add_residuals(mod2, \"resid2\")\n\nbikes_daily |> \n  ggplot(aes(x = date, y = resid2)) +\n  geom_point()\n\nWarning: Removed 1 rows containing missing values (`geom_point()`).\n\n\n\n\nbikes_daily |> \n  ggplot(aes(x = temp_m, y = resid2, color = season2)) +\n  geom_point() +\n  geom_smooth(span = 1, se = FALSE)\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\nWarning: Removed 1 rows containing non-finite values (`stat_smooth()`).\nRemoved 1 rows containing missing values (`geom_point()`).\n\n\n\n\nbikes_daily |> \n  filter(abs(resid2) > 1500) \n\n# A tibble: 20 × 11\n   date           n temp_h temp_l temp_m wday  month  resid season season2      \n   <date>     <dbl>  <dbl>  <dbl>  <dbl> <ord> <ord>  <dbl> <fct>  <fct>        \n 1 2011-03-10   623   0.44   0.34  0.389 Thu   Mar   -2257. winter winter(1.1~4…\n 2 2011-04-16   795   0.52   0.36  0.431 Sat   Apr   -2449. spring winter(1.1~4…\n 3 2011-07-04  6043   0.82   0.64  0.727 Mon   Jul    1519. summer spring/summe…\n 4 2011-08-27  1115   0.7    0.64  0.68  Sat   Aug   -3482. summer spring/summe…\n 5 2011-09-06  2710   0.54   0.54  0.54  Tue   Sep   -1431. summer spring/summe…\n 6 2011-09-07  1996   0.64   0.54  0.599 Wed   Sep   -2473. summer spring/summe…\n 7 2011-09-08  1842   0.7    0.6   0.634 Thu   Sep   -2728. summer spring/summe…\n 8 2011-09-23  2395   0.62   0.58  0.609 Fri   Sep   -2111. fall   spring/summe…\n 9 2011-10-12  2416   0.56   0.54  0.543 Wed   Oct   -1748. fall   fall(~12.31) \n10 2011-10-13  2913   0.66   0.54  0.589 Thu   Oct   -1513. fall   fall(~12.31) \n11 2011-10-19  2424   0.6    0.5   0.542 Wed   Oct   -1729. fall   fall(~12.31) \n12 2011-10-29   627   0.3    0.22  0.254 Sat   Oct   -1272. fall   fall(~12.31) \n13 2011-11-16  1817   0.48   0.42  0.457 Wed   Nov   -1655. fall   fall(~12.31) \n14 2011-11-22  1607   0.5    0.38  0.417 Tue   Nov   -1512. fall   fall(~12.31) \n15 2011-11-24  1495   0.5    0.26  0.373 Thu   Nov   -1253. fall   fall(~12.31) \n16 2011-12-07   705   0.48   0.24  0.41  Wed   Dec   -2355. fall   fall(~12.31) \n17 2011-12-24  1011   0.34   0.24  0.302 Sat   Dec   -1205. winter fall(~12.31) \n18 2011-12-25   754   0.36   0.2   0.275 Sun   Dec   -1276. winter fall(~12.31) \n19 2011-12-26  1317   0.38   0.22  0.322 Mon   Dec   -1035. winter fall(~12.31) \n20 2011-12-27  1162   0.44   0.26  0.325 Tue   Dec   -1213. winter fall(~12.31) \n# … with 1 more variable: resid2 <dbl>\n\np <- bikes_daily |> \n  mutate(outlier = abs(resid2) > 1500) |> \n  ggplot(aes(x = date, y = resid2, color = outlier)) +\n  geom_point()\nggplotly(p)\n\n\n\n\n# https://www.timeanddate.com/holidays/us/2011"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "1 + 1\n\n[1] 2"
  }
]